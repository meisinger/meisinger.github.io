<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Meisinger Two"><meta property="og:type" content="article"><meta property="og:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta property="twitter:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta name=title content="Rhino Mocks Final Stretch–Field Problems"><meta property="og:title" content="Rhino Mocks Final Stretch–Field Problems"><meta property="twitter:title" content="Rhino Mocks Final Stretch–Field Problems"><meta name=description content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="twitter:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:url" content="https://meisinger.github.io/post/2014-03-04-rhino-mocks-final-stretchfield-problems/"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=/img/favicon.ico><title>Rhino Mocks Final Stretch–Field Problems - Meisinger Two</title><link rel=canonical href=/post/2014-03-04-rhino-mocks-final-stretchfield-problems/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css integrity=sha512-... crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/main.css></head><body><nav><div><div class=title-container><button type=button>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=site-title href=/>Meisinger Two
<span class=site-slogan>Soul Proprietor</span></a></div><div class=menu-items-container><ul class=menu-items><li><a href=/>Home</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div></div><script>var $toggle=document.querySelector(".navbar-toggle");$toggle.addEventListener("click",toggle_navbar);function toggle_navbar(){var t=document.querySelector("#huxblog_navbar"),n=document.querySelector(".navbar-collapse");t.className.indexOf("in")>0?(t.className=" ",setTimeout(function(){t.className.indexOf("in")<0&&(n.style.height="0px")},400)):(n.style.height="auto",t.className+=" in")}</script></nav><article><section class=header><h2 data-label=title>Rhino Mocks Final Stretch–Field Problems</h2><h6 data-label=reading-time><i class="fa fa-clock"></i>
3 minute read</h6></section><section class=content><p>The final modifications have been made to the Rhino Mocks code base. It has been interesting working through Properties and Events.
What was more interesting, however, were the delegates. Previously these were Callback, Do and WhenCalled and allowed you to pass in a delegate,
an Action or a Func to modify the execution flow, change the return value or simply call a delegate.
Understanding when to use Callback, Do or WhenCalled was confusing to me so I decided to wrap them up a little differently.</p><p>Previously, WhenCalled allowed you to execute an Action that took, as a single parameter, a data structure encapsulating the method invocation.
Since an Action was being invoked the return value of the expectation could not be changed.</p><p>In the current version, WhenCalled has been modified slightly to simply execute an Action.
If the arguments of the calling method are desired then the Action will need to have the same signature of the calling method.
One thing that I am continuing to work through is the ability to match the arguments with the parameters of the Action (or delegate) without having
to specify all of them. It works but not with “out” or “ref” arguments.</p><p>The Callback functionality wasn’t something that I used in the past. The exact reason why this functionality was added is also unknown.
From the call signature, unit tests and the way it was executed I can only assume that it was used to validate the arguments of the calling method.
This feature has not been brought forward. Not that there isn’t a need but with the available argument constraints I don’t understand the need.
If the Callback feature is to ever return it will be re-worded to something like ValidateArgs.</p><p>“Do” has been replaced with DoInstead and is meant to allow you to replace the return value from the given Func (or delegate).
I don’t particularly like the “Do” notion and may change it to “ReturnInstead.”
This may seem like something silly to be considering but the names of the extension methods should reflect their intent as much as possible.</p><p>In order to provide a similar feature as the original “WhenCalled”, a new method “Intercept” has been added which expects an Action that takes, as a single parameter,
a data structure encapsulating the method invocation. Again, not too certain that I like the name of the method.
I also question whether having access to the method invocation is necessary or not. Only time will tell.</p><p>I have updated the existing unit tests to use these new constructs over the old and they all pass.
So while the code and execution remains the same (or similar), the names of the methods and properly expressing their intent may need some more work.</p><p>With all of the “major” unit tests now passing, it is on to the Field Problem unit tests.
There are only 104 files to go over so hopefully it will go by quickly. I am hoping that all of them can be converted and pass with limited modification.
I have an uneasy feeling, however, that some may need to be removed.
It will be important to identify and document what get’s removed in order to speak to them, provide justification and alternatives.</p><p>As a side note, someone had asked if this code is on GitHub. The current version that I am working on can be found here:</p><p><a href=https://github.com/meisinger/rhino-mocks/tree/innovation>Innovation Branch</a></p><p>This will get merged into the “master” branch once the Field Problem unit tests have been added (and passing).</p><p>Well… back to unit tests…</p></section><section class=footer><div class=tags><label>Tags:</label><div data-type=taxonomy><a href=/tags/rhino-mocks title="Rhino Mocks">Rhino Mocks</a></div></div><div class=categories><label>Categories:</label><div data-type=taxonomy><a href=/categories/development title=Development>Development</a></div></div><h6 data-label=meta>Posted on Tuesday, March 4, 2014</h6></section><section class=navigation><a href=/post/2013-10-22-rhino-mocks-expectations-for-events/>Previous
</a><a href=/post/2014-03-17-rhino-mocks-nuget/>Next</a></section></article><footer><ul><li><a href=mailto:mike.meisinger@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/meisinger><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/yourlinkedinid><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><div data-label=copyright>Copyright &copy; 2025 Mike Meisinger</div></footer></body></html>