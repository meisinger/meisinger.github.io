<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Meisinger Two"><meta property="og:type" content="article"><meta property="og:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta property="twitter:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta name=title content="Rhino Mocks Expectations for Events"><meta property="og:title" content="Rhino Mocks Expectations for Events"><meta property="twitter:title" content="Rhino Mocks Expectations for Events"><meta name=description content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="twitter:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:url" content="https://meisinger.github.io/post/2013-10-22-rhino-mocks-expectations-for-events/"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=/img/favicon.ico><title>Rhino Mocks Expectations for Events - Meisinger Two</title><link rel=canonical href=/post/2013-10-22-rhino-mocks-expectations-for-events/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css integrity=sha512-... crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/main.css></head><body><nav><div><div class=title-container><button type=button>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=site-title href=/>Meisinger Two
<span class=site-slogan>Soul Proprietor</span></a></div><div class=menu-items-container><ul class=menu-items><li><a href=/>Home</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div></div><script>var $toggle=document.querySelector(".navbar-toggle");$toggle.addEventListener("click",toggle_navbar);function toggle_navbar(){var t=document.querySelector("#huxblog_navbar"),n=document.querySelector(".navbar-collapse");t.className.indexOf("in")>0?(t.className=" ",setTimeout(function(){t.className.indexOf("in")<0&&(n.style.height="0px")},400)):(n.style.height="auto",t.className+=" in")}</script></nav><article><section class=header><h2 data-label=title>Rhino Mocks Expectations for Events</h2><h6 data-label=reading-time><i class="fa fa-clock"></i>
3 minute read</h6></section><section class=content><p>If one of the features I don’t use very often is the [Property Behavior]({% post_url 2013-09-17-rhino-mocks-property-behavior %}) then it’s safe to say that
I have never (ever) used “events” within Rhino Mocks.
I have seen the <code>Raise</code> and <code>GetEventRaiser</code> extension methods in the passed but never used them.</p><p>After working through the Property Behavior feature I decided to tackle handling events.
I found setting up expectations for events to be really easy.
Why? Because there is nothing to them. No really. There is nothing to them at all.
The only thing that you can do with events is validate (or expect) subscribing or unsubscribing from an event.</p><p>Think about that for a second.</p><p>When subscribing to an event you (typically) will use the “+=” assignment operator.
When unsubscribing from an event you (typically) will use the “-=” assignment operator.
Under the hood you are calling the “add” and “remove” methods respectively but there really isn’t anything you can do beyond that.
Both methods are “void” which means there is nothing to return or “mock" to return.
Sure, you could throw an exception but I find that to be an extreme edge case that should never be tested.
The only other thing you could do is perform a type of callback after subscribing or unsubscribing.</p><p>So really, when it comes down to it, the only thing you can do is setup an expectation to validate that an event handler was added or removed.
As a part of that expectation you may choose to make the event handler very (very) specific.</p><p>The one thing that I don’t like about the current implementation is that you can use <strong>null</strong> as the event handler when setting up the expectation.
Unless you follow that up with a call to the <code>IgnoreArguments</code> method, the expectation will be looking specifically for <strong>null</strong> to be passed.
I can’t tell if this is actually useful to anyone or not.
Perhaps instead <strong>null</strong> can be used to represent anything and thus avoiding the need to call <code>IgnoreArguments</code>.</p><p>Just as with the other refinements, there is a new extension method specifically for events named <strong>ExpectEvent</strong>:</p><div class=highlight><pre tabindex=0 style=color:#c8d3f5;background-color:#222436;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#82aaff>[Test]</span>
</span></span><span style=display:flex><span><span style=color:#c099ff>public</span> <span style=color:#c099ff>void</span> New_Event_Extension_Method() {
</span></span><span style=display:flex><span>  <span style=color:#4fd6be>var</span> mock = Repository.Mock&amp;lt;IConnection&amp;gt;();
</span></span><span style=display:flex><span>  mock.ExpectEvent(x =&gt; x.OnShutdown += <span style=color:#ffc777>null</span>);
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  mock.Verify();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The options that are returned are greatly reduced. So much so that <code>GetEventRaiser</code> has been removed as well.
Right now I am thinking that the <code>Raise</code> extension method works better.
And speaking of the <code>GetEventRaiser</code> and the <code>Raise</code> methods (which have not been until now), these methods are simply helper methods for calling the event.
Nothing more and nothing less.</p><p>Having never used events within Rhino Mocks caused a little bit of delay due to the confusion.
The exact things that I am trying to correct are some of the reason for the confusion.
By making the extension methods explicit and the" “fluid” interfaces more specific will definitely help.</p><p>Up next: Wrapping up.</p></section><section class=footer><div class=tags><label>Tags:</label><div data-type=taxonomy><a href=/tags/rhino-mocks title="Rhino Mocks">Rhino Mocks</a></div></div><div class=categories><label>Categories:</label><div data-type=taxonomy><a href=/categories/development title=Development>Development</a></div></div><h6 data-label=meta>Posted on Tuesday, October 22, 2013</h6></section><section class=navigation><a href=/post/2013-09-17-rhino-mocks-property-behavior/>Previous
</a><a href=/post/2014-03-04-rhino-mocks-final-stretchfield-problems/>Next</a></section></article><footer><ul><li><a href=mailto:mike.meisinger@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/meisinger><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/yourlinkedinid><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><div data-label=copyright>Copyright &copy; 2025 Mike Meisinger</div></footer></body></html>