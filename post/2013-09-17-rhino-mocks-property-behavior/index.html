<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Meisinger Two"><meta property="og:type" content="article"><meta property="og:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta property="twitter:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta name=title content="Rhino Mocks Property Behavior"><meta property="og:title" content="Rhino Mocks Property Behavior"><meta property="twitter:title" content="Rhino Mocks Property Behavior"><meta name=description content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="twitter:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:url" content="https://meisinger.github.io/post/2013-09-17-rhino-mocks-property-behavior/"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=/img/favicon.ico><title>Rhino Mocks Property Behavior - Meisinger Two</title><link rel=canonical href=/post/2013-09-17-rhino-mocks-property-behavior/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css integrity=sha512-... crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/main.css></head><body><nav><div><div class=title-container><button type=button>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=site-title href=/>Meisinger Two
<span class=site-slogan>Soul Proprietor</span></a></div><div class=menu-items-container><ul class=menu-items><li><a href=/>Home</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div></div><script>var $toggle=document.querySelector(".navbar-toggle");$toggle.addEventListener("click",toggle_navbar);function toggle_navbar(){var t=document.querySelector("#huxblog_navbar"),n=document.querySelector(".navbar-collapse");t.className.indexOf("in")>0?(t.className=" ",setTimeout(function(){t.className.indexOf("in")<0&&(n.style.height="0px")},400)):(n.style.height="auto",t.className+=" in")}</script></nav><article><section class=header><h2 data-label=title>Rhino Mocks Property Behavior</h2><h6 data-label=reading-time><i class="fa fa-clock"></i>
2 minute read</h6></section><section class=content><p>One feature that I seldom use in Rhino Mocks is the “Property Behavior.”
I remember getting an exception every now and then when I would use a property but never really thought much of it
(like a mindless drone I would change the code and run the unit tests again).</p><p>In fact, I used properties so infrequently in my unit tests, it wasn’t until I started diving deep into the code that I came to realize there are
three “property” based options:</p><ul><li><code>PropertyBehavior</code></li><li><code>SetPropertyAndIgnoreArguments</code></li><li><code>SetPropertyWithArgument</code></li></ul><p>After working through the Recursive Mock feature I found that properties are fairly easy to deal with.
That is until I tried to setup an expectation for a property based on the value being set.</p><p>As it turns out, when a property is used in a delegate the signature has a return value regardless of the operation.
This makes thing really difficult to handle when the expectation is being created for a “write-only” property.</p><p>The solution has been to create a new type of expectation that handles properties specifically.
The expectation captures both the <code>get</code> and <code>set</code> method at the same time. This allows properties to act more like first class expectations without
needing to add _special_ extensions.</p><p>Granted, to utilize the new expectation you will need to call <code>ExpectProperty</code> rather than <code>Expect</code>.
So I guess that is a _special_ extension but… you get the point.
There are still some things that need to be considered like whether or not properties should have Repeat options but for the most part it’s done.</p><p>One thing that I think is important to point out is the original handling of a property through the <code>Expect</code> method remains the same.
It’s only when extra functionality is needed do you need to think about utilizing the <code>ExpectProperty</code> method.</p><p>If you’re anything like me, this feature will be useless. Until you need it.</p><p>Next up; events…</p></section><section class=footer><div class=tags><label>Tags:</label><div data-type=taxonomy><a href=/tags/rhino-mocks title="Rhino Mocks">Rhino Mocks</a></div></div><div class=categories><label>Categories:</label><div data-type=taxonomy><a href=/categories/development title=Development>Development</a></div></div><h6 data-label=meta>Posted on Tuesday, September 17, 2013</h6></section><section class=navigation><a href=/post/2013-08-20-recursive-mocks/>Previous
</a><a href=/post/2013-10-22-rhino-mocks-expectations-for-events/>Next</a></section></article><footer><ul><li><a href=mailto:mike.meisinger@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/meisinger><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/yourlinkedinid><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><div data-label=copyright>Copyright &copy; 2025 Mike Meisinger</div></footer></body></html>