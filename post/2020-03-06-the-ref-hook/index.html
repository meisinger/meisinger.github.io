<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Meisinger Two"><meta property="og:type" content="article"><meta property="og:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta property="twitter:image" content="https://meisinger.github.io//assets/images/header-code.jpg"><meta name=title content="The Ref"><meta property="og:title" content="The Ref"><meta property="twitter:title" content="The Ref"><meta name=description content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="twitter:description" content="A friendly blog covering my journey through software development over the past twenty years"><meta property="og:url" content="https://meisinger.github.io/post/2020-03-06-the-ref-hook/"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=/img/favicon.ico><title>The Ref - Meisinger Two</title><link rel=canonical href=/post/2020-03-06-the-ref-hook/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css integrity=sha512-... crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/scss/main.css></head><body><nav><div><div class=title-container><button type=button>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=site-title href=/>Meisinger Two
<span class=site-slogan>Soul Proprietor</span></a></div><div class=menu-items-container><ul class=menu-items><li><a href=/>Home</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div></div><script>var $toggle=document.querySelector(".navbar-toggle");$toggle.addEventListener("click",toggle_navbar);function toggle_navbar(){var t=document.querySelector("#huxblog_navbar"),n=document.querySelector(".navbar-collapse");t.className.indexOf("in")>0?(t.className=" ",setTimeout(function(){t.className.indexOf("in")<0&&(n.style.height="0px")},400)):(n.style.height="auto",t.className+=" in")}</script></nav><article><section class=header><h2 data-label=title>The Ref</h2><h6 data-label=reading-time><i class="fa fa-clock"></i>
4 minute read</h6></section><section class=content><p>No. Not the movie. The <code>hook</code>.</p><p>If you&rsquo;ve never seen the movie &ldquo;The Ref&rdquo; then you owe it to yourself (and Denis Leary) to give it a watch sometime. It has its moments.</p><p>But we&rsquo;re not here to talk about the movie. Instead we are going to talk about the <code>useRef</code> hook.</p><h2 id=this-is-not-the-reference-youre-looking-for>This Is Not The Reference You&rsquo;re Looking For</h2><p>When I think of a reference in React I think about using <em>(what React calls)</em> a &ldquo;Callback Ref&rdquo; like this:</p><div class=highlight><pre tabindex=0 style=color:#c8d3f5;background-color:#222436;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#c3e88d;font-weight:700>&lt;</span>div ref<span style=color:#c3e88d;font-weight:700>=</span>{(ref) =&gt; <span style=color:#c099ff>this</span>.component <span style=color:#c3e88d;font-weight:700>=</span> ref}<span style=color:#c3e88d;font-weight:700>&gt;</span>Hello World<span style=color:#c3e88d;font-weight:700>!&lt;</span><span style=color:#c53b53>/div&gt;</span>
</span></span></code></pre></div><p>Where basically you are grabbing the reference to an existing component and setting it a variable for later use. It should go without saying but, this only works within the Class paradigm of React.</p><p>But clearly, this is not the reference we are looking for.</p><p>Instead the <code>useRef</code> hook operates in the reverse by creating a reference that you can then assign to a component. Like as follows:</p><div class=highlight><pre tabindex=0 style=color:#c8d3f5;background-color:#222436;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#c099ff>const</span> ref <span style=color:#c3e88d;font-weight:700>=</span> useRef()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c099ff>return</span> (
</span></span><span style=display:flex><span>  <span style=color:#c3e88d;font-weight:700>&lt;</span>div ref<span style=color:#c3e88d;font-weight:700>=</span>{ref}<span style=color:#c3e88d;font-weight:700>&gt;</span>Hello World<span style=color:#c3e88d;font-weight:700>!&lt;</span><span style=color:#c53b53>/div&gt;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h2 id=making-the-wrong-calls>Making The Wrong Calls</h2><p>When using the &ldquo;Callback Ref&rdquo; approach the reference has already been created and is well known. In the previous example, React knows that the reference is a DOM element. Therefore we can access the reference directly (e.g. <code>this.component.focus()</code>).</p><p>When using the <code>useRef</code> hook however, we don&rsquo;t know what the underlying reference is yet. We have to wait until we assign it before React knows what the reference points to.</p><p>Because we don&rsquo;t yet know until the assignment, when we use the <code>useRef</code> hook we can&rsquo;t access the reference directly like we normally would. Instead we have to go through the <code>current</code> property. Like this:</p><div class=highlight><pre tabindex=0 style=color:#c8d3f5;background-color:#222436;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#c099ff>export</span> <span style=color:#c099ff>default</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> ref <span style=color:#c3e88d;font-weight:700>=</span> useRef()
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> clicked <span style=color:#c3e88d;font-weight:700>=</span> () =&gt; {
</span></span><span style=display:flex><span>    ref.current.focus()
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#c099ff>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#c3e88d;font-weight:700>&lt;</span>div<span style=color:#c3e88d;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c3e88d;font-weight:700>&lt;</span>div<span style=color:#c3e88d;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#c3e88d;font-weight:700>&lt;</span>input ref<span style=color:#c3e88d;font-weight:700>=</span>{ref} type<span style=color:#c3e88d;font-weight:700>=</span><span style=color:#c3e88d>&#34;text&#34;</span> <span style=color:#c3e88d;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c3e88d;font-weight:700>&lt;</span><span style=color:#c53b53>/div&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c3e88d;font-weight:700>&lt;</span>button onClick<span style=color:#c3e88d;font-weight:700>=</span>{() =&gt; clicked()}<span style=color:#c3e88d;font-weight:700>&gt;</span>Focus Up<span style=color:#c3e88d;font-weight:700>&lt;</span><span style=color:#c53b53>/button&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#c3e88d;font-weight:700>&lt;</span><span style=color:#c53b53>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>From this example we can see what is really happening under the covers.</p><p>In reality, when the <code>ref</code> is assigned to the <code>&lt;input /></code> element, React sets the <code>current</code> property for our <code>ref</code> to the DOM element. This means that our <code>ref</code> is mutable through the <code>current</code> property</p><h2 id=wait-what>Wait, What?</h2><p>With the understanding that the <code>useRef</code> hook produces a mutable value via the <code>current</code> property, this opens up more options to us then before with the simple &ldquo;Callback Ref&rdquo; approach.</p><p>With <code>useRef</code> we can store timers, intervals, DOM elements or even <em>(wait for it&mldr;)</em> <code>Animated.Value</code> in React Native.</p><div class=highlight><pre tabindex=0 style=color:#c8d3f5;background-color:#222436;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#c099ff>export</span> <span style=color:#c099ff>default</span> ({ active, activeTint <span style=color:#c3e88d;font-weight:700>=</span> <span style=color:#c3e88d>&#39;#900&#39;</span>, inactiveTint <span style=color:#c3e88d;font-weight:700>=</span> <span style=color:#c3e88d>&#39;#000&#39;</span> }) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> animatedColor <span style=color:#c3e88d;font-weight:700>=</span> Animated.Value(<span style=color:#ffc777>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> refColor <span style=color:#c3e88d;font-weight:700>=</span> useRef(animatedColor)
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> textColor <span style=color:#c3e88d;font-weight:700>=</span> refColor.current.interpolate({
</span></span><span style=display:flex><span>    inputRange<span style=color:#c3e88d;font-weight:700>:</span> [<span style=color:#ffc777>0</span>, <span style=color:#ffc777>1</span>],
</span></span><span style=display:flex><span>    outputRange<span style=color:#c3e88d;font-weight:700>:</span> [
</span></span><span style=display:flex><span>      inactiveTint,
</span></span><span style=display:flex><span>      activeTint
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> [lastActive, setLastActive] <span style=color:#c3e88d;font-weight:700>=</span> useState(<span style=color:#ffc777>false</span>)
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#c099ff>if</span> (active <span style=color:#c3e88d;font-weight:700>!==</span> lastActive) {
</span></span><span style=display:flex><span>      Animated.timing(refColor.current, {
</span></span><span style=display:flex><span>        toValue<span style=color:#c3e88d;font-weight:700>:</span> (active) <span style=color:#c3e88d;font-weight:700>?</span> <span style=color:#ffc777>1</span> <span style=color:#c3e88d;font-weight:700>:</span> <span style=color:#ffc777>0</span>,
</span></span><span style=display:flex><span>        duration<span style=color:#c3e88d;font-weight:700>:</span> <span style=color:#ffc777>175</span>
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    setLastActive(active)
</span></span><span style=display:flex><span>  }, [active])
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> text_style <span style=color:#c3e88d;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    fontSize<span style=color:#c3e88d;font-weight:700>:</span> <span style=color:#ffc777>16</span>,
</span></span><span style=display:flex><span>    color<span style=color:#c3e88d;font-weight:700>:</span> textColor
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#c099ff>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#c3e88d;font-weight:700>&lt;</span>Animated.View<span style=color:#c3e88d;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#c3e88d;font-weight:700>&lt;</span>Animated.Text style<span style=color:#c3e88d;font-weight:700>=</span>{text_style}<span style=color:#c3e88d;font-weight:700>&gt;</span>Hello World<span style=color:#c3e88d;font-weight:700>&lt;</span><span style=color:#c53b53>/Animted.Text&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#c3e88d;font-weight:700>&lt;</span><span style=color:#c53b53>/Animated.View&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Sure, this is a silly example but it shows the potential.</p><p>Basically what we have a created a component that when <code>active</code> shows the text in &ldquo;red&rdquo; and when not <code>active</code> whos the text in &ldquo;black&rdquo;
When the property changes we animate the color change.</p><p>Does anyone else smell a custom <code>hook</code> in our future? Nah, probably not.</p><h2 id=silver-reference>Silver Reference?</h2><p>As cool as <code>useRef</code> is, it should really be used sparingly. Having a mutable variable might sound like a solution to a lot of things
but it does come with some caveats.</p><p>For one thing, changes to the <code>ref</code> is a side effect so it must be done within a <code>useEffect</code> function.
Along those same lines, changing (or mutating) the <code>current</code> property doesn&rsquo;t trigger a re-render.</p><p>And then we get to the whole &ldquo;sharing ref&rdquo; conversation which should honestly be avoided as much as possible.
If you run into a situation where you think &ldquo;sharing a ref&rdquo; will solve your problem, give the problem a second look. There may be a larger
underlying problem lurking around some where.</p><h2 id=setting-that-native-props>Setting That Native Props</h2><p>Unfortunatley, if you need access to <code>setNativeProps</code> within React Native, you can&rsquo;t help but use <code>useRef</code>.</p><p>There is no way around it as far as I know.</p><div class=highlight><pre tabindex=0 style=color:#c8d3f5;background-color:#222436;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#c099ff>export</span> <span style=color:#c099ff>default</span> ({ subject, ...props }) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#c099ff>const</span> component <span style=color:#c3e88d;font-weight:700>=</span> useRef()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#c099ff>const</span> $stream <span style=color:#c3e88d;font-weight:700>=</span> subject
</span></span><span style=display:flex><span>      .subscribe(data =&gt; {
</span></span><span style=display:flex><span>        component.current.setNativeProps({ text<span style=color:#c3e88d;font-weight:700>:</span> data })
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c099ff>return</span> () =&gt; $stream.unsubscribe()
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#c099ff>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#c3e88d;font-weight:700>&lt;</span>TextInput ref<span style=color:#c3e88d;font-weight:700>=</span>{component} {...props} onChangeText<span style=color:#c3e88d;font-weight:700>=</span>{subject.changed} <span style=color:#c3e88d;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Covering everything going on here is a little beyond the scope of this conversation but, it is important to note that
in order to set the <code>text</code> property of the <code>TextInput</code> component you need to be able to call the <code>setNativeProps</code>.</p><p>That can only be accessed with a reference to the component, hence&mldr; <code>useRef</code></p><p>Perhaps we can cover what is happening in this example in the next post&mldr; stay tuned.</p></section><section class=footer><div class=tags><label>Tags:</label><div data-type=taxonomy><a href=/tags/react title=React>React</a></div><div data-type=taxonomy><a href=/tags/react-native title=React-Native>React-Native</a></div></div><div class=categories><label>Categories:</label><div data-type=taxonomy><a href=/categories/development title=Development>Development</a></div></div><h6 data-label=meta>Posted on Friday, March 6, 2020</h6></section><section class=navigation><a href=/post/2020-03-04-creating-hooks/>Previous
</a><a href=/post/2025-08-16-rhino-core/>Next</a></section></article><footer><ul><li><a href=mailto:mike.meisinger@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/meisinger><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/yourlinkedinid><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><div data-label=copyright>Copyright &copy; 2025 Mike Meisinger</div></footer></body></html>